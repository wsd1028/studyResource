<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="./css/element.css">
    <link rel="stylesheet" href="./css/iconfont/iconfont.css">
    <link rel="stylesheet" href="./css/home.min.css">
    <title>全链路</title>
    <style>
        #wholeLink {
            width: 800px;
            height: 500px;
        }
    </style>
</head>

<body>
    <div id="main" class="homeShow">
        <div id="wholeLink"></div>
    </div>
    <script src="./js/es6-shim.min.js"></script>
    <script src="./js/vue.js"></script>
    <script src="./js/element.js"></script>
    <script src="./js/echarts/dist/echarts.min.js"></script>
    <script src="./js/hunan.js"></script>
    <script>
        var v = new Vue({
            el: "#main",
            data: {
                mainData: []
            },
            methods: {
                drawRouteChart: function (id) {
                    let that = this;
                    var myChart = echarts.init(document.getElementById(id));
                    var nodes = [{
                            name: '普通节点1',
                            img: 'path://M30.9,53.2C16.8,53.2,5.3,41.7,5.3,27.6S16.8,2,30.9,2C45,2,56.4,13.5,56.4,27.6S45,53.2,30.9,53.2z M30.9,3.5C17.6,3.5,6.8,14.4,6.8,27.6c0,13.3,10.8,24.1,24.101,24.1C44.2,51.7,55,40.9,55,27.6C54.9,14.4,44.1,3.5,30.9,3.5z M36.9,35.8c0,0.601-0.4,1-0.9,1h-1.3c-0.5,0-0.9-0.399-0.9-1V19.5c0-0.6,0.4-1,0.9-1H36c0.5,0,0.9,0.4,0.9,1V35.8z M27.8,35.8 c0,0.601-0.4,1-0.9,1h-1.3c-0.5,0-0.9-0.399-0.9-1V19.5c0-0.6,0.4-1,0.9-1H27c0.5,0,0.9,0.4,0.9,1L27.8,35.8L27.8,35.8z',
                            alarm: '产生告警了哦'
                        },
                        {
                            name: '普通节点2',
                            img: 'path://M30.9,53.2C16.8,53.2,5.3,41.7,5.3,27.6S16.8,2,30.9,2C45,2,56.4,13.5,56.4,27.6S45,53.2,30.9,53.2z M30.9,3.5C17.6,3.5,6.8,14.4,6.8,27.6c0,13.3,10.8,24.1,24.101,24.1C44.2,51.7,55,40.9,55,27.6C54.9,14.4,44.1,3.5,30.9,3.5z M36.9,35.8c0,0.601-0.4,1-0.9,1h-1.3c-0.5,0-0.9-0.399-0.9-1V19.5c0-0.6,0.4-1,0.9-1H36c0.5,0,0.9,0.4,0.9,1V35.8z M27.8,35.8 c0,0.601-0.4,1-0.9,1h-1.3c-0.5,0-0.9-0.399-0.9-1V19.5c0-0.6,0.4-1,0.9-1H27c0.5,0,0.9,0.4,0.9,1L27.8,35.8L27.8,35.8z',
                        },
                        {
                            name: '普通节点3',
                            img: 'path://M30.9,53.2C16.8,53.2,5.3,41.7,5.3,27.6S16.8,2,30.9,2C45,2,56.4,13.5,56.4,27.6S45,53.2,30.9,53.2z M30.9,3.5C17.6,3.5,6.8,14.4,6.8,27.6c0,13.3,10.8,24.1,24.101,24.1C44.2,51.7,55,40.9,55,27.6C54.9,14.4,44.1,3.5,30.9,3.5z M36.9,35.8c0,0.601-0.4,1-0.9,1h-1.3c-0.5,0-0.9-0.399-0.9-1V19.5c0-0.6,0.4-1,0.9-1H36c0.5,0,0.9,0.4,0.9,1V35.8z M27.8,35.8 c0,0.601-0.4,1-0.9,1h-1.3c-0.5,0-0.9-0.399-0.9-1V19.5c0-0.6,0.4-1,0.9-1H27c0.5,0,0.9,0.4,0.9,1L27.8,35.8L27.8,35.8z',
                        },
                        {
                            name: '普通节点4',
                            img: 'path://M30.9,53.2C16.8,53.2,5.3,41.7,5.3,27.6S16.8,2,30.9,2C45,2,56.4,13.5,56.4,27.6S45,53.2,30.9,53.2z M30.9,3.5C17.6,3.5,6.8,14.4,6.8,27.6c0,13.3,10.8,24.1,24.101,24.1C44.2,51.7,55,40.9,55,27.6C54.9,14.4,44.1,3.5,30.9,3.5z M36.9,35.8c0,0.601-0.4,1-0.9,1h-1.3c-0.5,0-0.9-0.399-0.9-1V19.5c0-0.6,0.4-1,0.9-1H36c0.5,0,0.9,0.4,0.9,1V35.8z M27.8,35.8 c0,0.601-0.4,1-0.9,1h-1.3c-0.5,0-0.9-0.399-0.9-1V19.5c0-0.6,0.4-1,0.9-1H27c0.5,0,0.9,0.4,0.9,1L27.8,35.8L27.8,35.8z',
                        },
                        {
                            name: '普通节点5',
                            img: 'path://M30.9,53.2C16.8,53.2,5.3,41.7,5.3,27.6S16.8,2,30.9,2C45,2,56.4,13.5,56.4,27.6S45,53.2,30.9,53.2z M30.9,3.5C17.6,3.5,6.8,14.4,6.8,27.6c0,13.3,10.8,24.1,24.101,24.1C44.2,51.7,55,40.9,55,27.6C54.9,14.4,44.1,3.5,30.9,3.5z M36.9,35.8c0,0.601-0.4,1-0.9,1h-1.3c-0.5,0-0.9-0.399-0.9-1V19.5c0-0.6,0.4-1,0.9-1H36c0.5,0,0.9,0.4,0.9,1V35.8z M27.8,35.8 c0,0.601-0.4,1-0.9,1h-1.3c-0.5,0-0.9-0.399-0.9-1V19.5c0-0.6,0.4-1,0.9-1H27c0.5,0,0.9,0.4,0.9,1L27.8,35.8L27.8,35.8z',
                            alarm: '产生告警了哦'
                        },
                        {
                            name: '普通节点6',
                            img: 'path://M30.9,53.2C16.8,53.2,5.3,41.7,5.3,27.6S16.8,2,30.9,2C45,2,56.4,13.5,56.4,27.6S45,53.2,30.9,53.2z M30.9,3.5C17.6,3.5,6.8,14.4,6.8,27.6c0,13.3,10.8,24.1,24.101,24.1C44.2,51.7,55,40.9,55,27.6C54.9,14.4,44.1,3.5,30.9,3.5z M36.9,35.8c0,0.601-0.4,1-0.9,1h-1.3c-0.5,0-0.9-0.399-0.9-1V19.5c0-0.6,0.4-1,0.9-1H36c0.5,0,0.9,0.4,0.9,1V35.8z M27.8,35.8 c0,0.601-0.4,1-0.9,1h-1.3c-0.5,0-0.9-0.399-0.9-1V19.5c0-0.6,0.4-1,0.9-1H27c0.5,0,0.9,0.4,0.9,1L27.8,35.8L27.8,35.8z',
                        },
                        {
                            name: '控制台',
                            img: 'path://M30.9,53.2C16.8,53.2,5.3,41.7,5.3,27.6S16.8,2,30.9,2C45,2,56.4,13.5,56.4,27.6S45,53.2,30.9,53.2z M30.9,3.5C17.6,3.5,6.8,14.4,6.8,27.6c0,13.3,10.8,24.1,24.101,24.1C44.2,51.7,55,40.9,55,27.6C54.9,14.4,44.1,3.5,30.9,3.5z M36.9,35.8c0,0.601-0.4,1-0.9,1h-1.3c-0.5,0-0.9-0.399-0.9-1V19.5c0-0.6,0.4-1,0.9-1H36c0.5,0,0.9,0.4,0.9,1V35.8z M27.8,35.8 c0,0.601-0.4,1-0.9,1h-1.3c-0.5,0-0.9-0.399-0.9-1V19.5c0-0.6,0.4-1,0.9-1H27c0.5,0,0.9,0.4,0.9,1L27.8,35.8L27.8,35.8z',
                        }
                    ]
                    var links = [{
                            source: '普通节点1',
                            target: '普通节点2',
                            name: '数据传输'
                        }, {
                            source: '普通节点2',
                            target: '普通节点3',
                            name: '数据传输'
                        },
                        {
                            source: '普通节点3',
                            target: '普通节点4',
                            name: '数据传输'
                        },
                        {
                            source: '普通节点4',
                            target: '普通节点5',
                            name: '数据传输'
                        },
                        {
                            source: '普通节点5',
                            target: '普通节点6',
                            name: '数据传输'
                        },
                        {
                            source: '普通节点6',
                            target: '普通节点1',
                            name: '数据传输'
                        },
                        {
                            source: '控制台',
                            target: '中心节点',
                            name: '访问'
                        }
                    ]

                    for (let i = 0; i < nodes.length; i++) {
                        nodes[i].angle = (360 / nodes.length * i)
                    }

                    nodes[nodes.length] = {
                        name: '中心节点',
                        img: 'path://M30.9,53.2C16.8,53.2,5.3,41.7,5.3,27.6S16.8,2,30.9,2C45,2,56.4,13.5,56.4,27.6S45,53.2,30.9,53.2z M30.9,3.5C17.6,3.5,6.8,14.4,6.8,27.6c0,13.3,10.8,24.1,24.101,24.1C44.2,51.7,55,40.9,55,27.6C54.9,14.4,44.1,3.5,30.9,3.5z M36.9,35.8c0,0.601-0.4,1-0.9,1h-1.3c-0.5,0-0.9-0.399-0.9-1V19.5c0-0.6,0.4-1,0.9-1H36c0.5,0,0.9,0.4,0.9,1V35.8z M27.8,35.8 c0,0.601-0.4,1-0.9,1h-1.3c-0.5,0-0.9-0.399-0.9-1V19.5c0-0.6,0.4-1,0.9-1H27c0.5,0,0.9,0.4,0.9,1L27.8,35.8L27.8,35.8z',
                        alarm: '产生告警了哦',
                        value: [0, 0]
                    }
                    var charts = {
                        nodes: [],
                        links: [],
                        linesData: []
                    }
                    var dataMap = new Map()
                    for (var j = 0; j < nodes.length; j++) {
                        var node = {
                            name: nodes[j].name,
                            value: [j * 100 + 40, 200],
                            symbolSize: 50,
                            alarm: nodes[j].alarm,
                            symbol: nodes[j].img,
                            itemStyle: {
                                normal: {
                                    color: '#12b5d0',
                                }
                            }
                        }
                        dataMap.set(nodes[j].name, node.value)
                        charts.nodes.push(node)
                    }
                    for (var i = 0; i < links.length; i++) {
                        var link = {
                            source: links[i].source,
                            target: links[i].target,
                            label: {
                                normal: {
                                    show: true,
                                    formatter: links[i].name
                                }
                            },
                            lineStyle: {
                                normal: {
                                    color: '#12b5d0'
                                }
                            }
                        }
                        charts.links.push(link)
                        // 组装动态移动的效果数据
                        var lines = {
                            coords: [
                                dataMap.get(links[i].source),
                                dataMap.get(links[i].target)
                            ]
                        }

                        charts.linesData.push(lines)
                    }
                    let option = {
                        geo: {
                            map: "北京市",
                            label: {
                                emphasis: {
                                    show: false
                                }
                            },
                            roam: true,
                            itemStyle: {
                                normal: {
                                    areaColor: "#323c48",
                                    borderColor: "#404a59"
                                },
                                emphasis: {
                                    areaColor: "#2a333d"
                                }
                            }
                        },
                        tooltip: {
                            formatter: function () {
                                return "123"
                            },
                        },
                        title: {
                            text: '全链路'
                        },
                        backgroundColor: "#F5F5F5",
                        polar: {},
                        radiusAxis: {
                            show: false
                        },
                        angleAxis: {
                            type: 'value',
                            show: false
                        },
                        series: [{
                            type: 'graph',
                            coordinateSystem: 'geo',
                            links: charts.links,
                            symbolSize: 50,
                            label: {
                                normal: {
                                    show: true,
                                    position: 'bottom',
                                    color: '#12b5d0'
                                }
                            },
                            lineStyle: {
                                normal: {
                                    width: 2,
                                    shadowColor: 'none'
                                }
                            },
                            edgeSymbolSize: 8,
                            data: charts.nodes,
                            itemStyle: {
                                normal: {
                                    label: {
                                        show: true,
                                        formatter: function (item) {
                                            return item.data.name
                                        }
                                    }
                                }
                            }
                        }, {
                            name: 'line',
                            type: 'lines',
                            coordinateSystem: 'geo',

                            lineStyle: {
                                color: '#a6c84c',
                                width: 1,
                                opacity: 0.6,
                                curveness: 0.5,

                            },
                            effect: {
                                show: true,
                                trailLength: 0,
                                symbol: 'triangle',
                                color: '#12b5d0',
                                symbolSize: 8
                            },
                            data: charts.linesData
                        }]
                    };
                    myChart.setOption(option);
                    myChart.on('click', function (params) {
                        console.log("sd",params);
                    });
                },

            },
            mounted: function () {
                this.drawRouteChart("wholeLink")
            }
        })
    </script>
</body>

</html>